(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-system-user-add"],{"0fee":function(a,e,t){"use strict";t.r(e);var i=t("6221"),l=t("ba9f");for(var n in l)["default"].indexOf(n)<0&&function(a){t.d(e,a,(function(){return l[a]}))}(n);t("bb3f");var o=t("828b"),r=Object(o["a"])(l["default"],i["b"],i["c"],!1,null,"08bb3850",null,!1,i["a"],void 0);e["default"]=r.exports},"5d0c":function(a,e,t){var i=t("c86c");e=i(!1),e.push([a.i,"[data-v-08bb3850] .uni-forms-item__label{width:90px!important}",""]),a.exports=e},6221:function(a,e,t){"use strict";t.d(e,"b",(function(){return l})),t.d(e,"c",(function(){return n})),t.d(e,"a",(function(){return i}));var i={uniForms:t("839b").default,uniFormsItem:t("7e33").default,uniEasyinput:t("f304").default,uniDataCheckbox:t("674a").default},l=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("v-uni-view",{staticClass:"uni-container"},[t("uni-forms",{ref:"form",attrs:{rules:a.rules,validateTrigger:"bind"},on:{submit:function(e){arguments[0]=e=a.$handleEvent(e),a.submit.apply(void 0,arguments)}},model:{value:a.formData,callback:function(e){a.formData=e},expression:"formData"}},[t("uni-forms-item",{attrs:{name:"username",label:"用户名",required:!0}},[t("uni-easyinput",{attrs:{clearable:!1,placeholder:"请输入用户名"},model:{value:a.formData.username,callback:function(e){a.$set(a.formData,"username",e)},expression:"formData.username"}})],1),t("uni-forms-item",{attrs:{name:"password",label:"初始密码",required:!0}},[t("uni-easyinput",{attrs:{clearable:!1,placeholder:"请输入初始密码"},model:{value:a.formData.password,callback:function(e){a.$set(a.formData,"password",e)},expression:"formData.password"}})],1),t("uni-forms-item",{attrs:{name:"airtabletoken",label:"tabletoken"}},[t("uni-easyinput",{attrs:{clearable:!1,placeholder:"airtabletoken"},model:{value:a.formData.airtabletoken,callback:function(e){a.$set(a.formData,"airtabletoken",e)},expression:"formData.airtabletoken"}})],1),t("uni-forms-item",{attrs:{name:"airtablebaseid",label:"tablebaseid"}},[t("uni-easyinput",{attrs:{clearable:!1,placeholder:"airtablebaseid"},model:{value:a.formData.airtablebaseid,callback:function(e){a.$set(a.formData,"airtablebaseid",e)},expression:"formData.airtablebaseid"}})],1),t("uni-forms-item",{attrs:{name:"airtabletableid",label:"tabletableid"}},[t("uni-easyinput",{attrs:{clearable:!1,placeholder:"airtabletableid"},model:{value:a.formData.airtabletableid,callback:function(e){a.$set(a.formData,"airtabletableid",e)},expression:"formData.airtabletableid"}})],1),t("uni-forms-item",{attrs:{name:"beizhutoken",label:"beizhutoken"}},[t("uni-easyinput",{attrs:{clearable:!1,placeholder:"beizhutoken"},model:{value:a.formData.beizhutoken,callback:function(e){a.$set(a.formData,"beizhutoken",e)},expression:"formData.beizhutoken"}})],1),t("uni-forms-item",{attrs:{name:"beizhubaseid",label:"beizhubaseid"}},[t("uni-easyinput",{attrs:{clearable:!1,placeholder:"beizhubaseid"},model:{value:a.formData.beizhubaseid,callback:function(e){a.$set(a.formData,"beizhubaseid",e)},expression:"formData.beizhubaseid"}})],1),t("uni-forms-item",{attrs:{name:"mobile",label:"手机号"}},[t("uni-easyinput",{attrs:{clearable:!1,placeholder:"请输入手机号"},model:{value:a.formData.mobile,callback:function(e){a.$set(a.formData,"mobile",e)},expression:"formData.mobile"}})],1),t("uni-forms-item",{attrs:{name:"shouquanma",label:"授权码"}},[t("uni-easyinput",{attrs:{clearable:!1,placeholder:"abcde"},model:{value:a.formData.shouquanma,callback:function(e){a.$set(a.formData,"shouquanma",e)},expression:"formData.shouquanma"}})],1),t("uni-forms-item",{staticClass:"flex-center-x",attrs:{name:"tags",label:"用户标签",labelWidth:"100"}},[t("uni-data-checkbox",{ref:"checkbox",attrs:{pageSize:100,multiple:!0,collection:"uni-id-tag",field:"tagid as value, name as text"},model:{value:a.formData.tags,callback:function(e){a.$set(a.formData,"tags",e)},expression:"formData.tags"}}),t("span",{staticClass:"link-btn",on:{click:function(e){arguments[0]=e=a.$handleEvent(e),a.gotoTagAdd.apply(void 0,arguments)}}},[a._v("新增")]),t("span",{staticClass:"link-btn",staticStyle:{"margin-left":"10px"},on:{click:function(e){arguments[0]=e=a.$handleEvent(e),a.gotoTagList.apply(void 0,arguments)}}},[a._v("管理")])],1),t("uni-forms-item",{attrs:{name:"city",label:"城市"}},[t("uni-easyinput",{attrs:{placeholder:"城市地址",trim:"both"},model:{value:a.formData.city,callback:function(e){a.$set(a.formData,"city",e)},expression:"formData.city"}})],1),t("uni-forms-item",{staticClass:"flex-center-x",attrs:{name:"role",label:"角色列表"}},[t("uni-data-checkbox",{attrs:{multiple:!0,localdata:a.roles},model:{value:a.formData.role,callback:function(e){a.$set(a.formData,"role",e)},expression:"formData.role"}})],1),t("uni-forms-item",{staticClass:"flex-center-x",attrs:{name:"dcloud_appid",label:"可登录应用",labelWidth:"100"}},[t("uni-data-checkbox",{attrs:{multiple:!0,collection:"opendb-app-list",field:"appid as value, name as text"},model:{value:a.formData.dcloud_appid,callback:function(e){a.$set(a.formData,"dcloud_appid",e)},expression:"formData.dcloud_appid"}}),t("span",{staticClass:"link-btn",on:{click:function(e){arguments[0]=e=a.$handleEvent(e),a.gotoAppList.apply(void 0,arguments)}}},[a._v("管理")])],1),t("uni-forms-item",{attrs:{name:"yaohao",label:"是否要号"}},[t("v-uni-switch",{attrs:{checked:a.formData.yaohao},on:{change:function(e){arguments[0]=e=a.$handleEvent(e),a.binddata("yaohao",e.detail.value)}}})],1),t("uni-forms-item",{attrs:{name:"saoma",label:"扫码功能"}},[t("v-uni-switch",{attrs:{checked:a.formData.saoma},on:{change:function(e){arguments[0]=e=a.$handleEvent(e),a.binddata("saoma",e.detail.value)}}})],1),t("uni-forms-item",{attrs:{name:"lock",label:"上锁与否"}},[t("v-uni-switch",{attrs:{checked:a.formData.lock},on:{change:function(e){arguments[0]=e=a.$handleEvent(e),a.binddata("lock",e.detail.value)}}})],1),t("uni-forms-item",{attrs:{name:"mobile_confirmed",label:"手机验证"}},[t("v-uni-switch",{attrs:{checked:a.formData.mobile_confirmed},on:{change:function(e){arguments[0]=e=a.$handleEvent(e),a.binddata("mobile_confirmed",e.detail.value)}}})],1),t("uni-forms-item",{attrs:{name:"status",label:"是否启用"}},[t("v-uni-switch",{attrs:{checked:a.formData.status},on:{change:function(e){arguments[0]=e=a.$handleEvent(e),a.binddata("status",e.detail.value)}}})],1),t("v-uni-view",{staticClass:"uni-button-group"},[t("v-uni-button",{staticClass:"uni-button",staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:function(e){arguments[0]=e=a.$handleEvent(e),a.submitForm.apply(void 0,arguments)}}},[a._v(a._s(a.$t("common.button.submit")))]),t("v-uni-navigator",{staticStyle:{"margin-left":"15px"},attrs:{"open-type":"navigateBack"}},[t("v-uni-button",{staticClass:"uni-button",staticStyle:{width:"100px"}},[a._v(a._s(a.$t("common.button.back")))])],1)],1)],1)],1)},n=[]},"7c5e":function(a,e,t){"use strict";t("6a54");var i=t("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.enumConverter=void 0,e.filterToWhere=function(a,e){var t={};for(var i in a){var o=a[i],r=o.type,s=o.value;switch(r){case"search":"string"===typeof s&&s.length&&(t[i]=new RegExp(s));break;case"select":if(s.length){var u,c=[],d=(0,n.default)(s);try{for(d.s();!(u=d.n()).done;){var m=u.value;c.push(e.eq(m))}}catch(_){d.e(_)}finally{d.f()}t[i]=e.or(c)}break;case"range":if(s.length){var f=s[0],b=s[1];t[i]=e.and([e.gte(f),e.lte(b)])}break;case"date":if(s.length){var p=(0,l.default)(s,2),h=p[0],v=p[1],g=new Date(h),k=new Date(v);t[i]=e.and([e.gte(g),e.lte(k)])}break;case"timestamp":if(s.length){var D=(0,l.default)(s,2),x=D[0],y=D[1];t[i]=e.and([e.gte(x),e.lte(y)])}break}}return t},e.validator=void 0;var l=i(t("5de6")),n=i(t("3471"));t("23f4"),t("7d2f"),t("5c47"),t("9c4e"),t("ab80"),t("aa9c");e.validator={shouquanma:{rules:[{format:"string"}]},wx_openid:{rules:[{format:"object"}]},username:{rules:[{format:"string"},{minLength:2}],title:"用户名",label:"用户名"},uid:{rules:[{format:"string"},{minLength:2}],title:"uid",label:"uid"},id:{rules:[{format:"string"},{minLength:2}],title:"id",label:"id"},password:{rules:[{format:"string"},{minLength:6}],title:"密码",label:"密码"},city:{rules:[{format:"string"}],title:"城市",label:"城市"},airtabletoken:{rules:[{format:"string"}],title:"airtabletoken",label:"airtabletoken"},airtablebaseid:{rules:[{format:"string"}],title:"airtablebaseid",label:"airtablebaseid"},airtabletableid:{rules:[{format:"string"}],title:"airtabletableid",label:"airtabletableid"},beizhutoken:{rules:[{format:"string"}],title:"beizhutoken",label:"beizhutoken"},beizhubaseid:{rules:[{format:"string"}],title:"beizhubaseid",label:"beizhubaseid"},status:{rules:[{format:"int"},{range:[{text:"正常",value:0},{text:"禁用",value:1},{text:"审核中",value:2},{text:"审核拒绝",value:3}]}],title:"用户状态",defaultValue:0,label:"用户状态"},yaohao:{rules:[{format:"bool"}]},saoma:{rules:[{format:"bool"}]},lock:{rules:[{format:"int"},{range:[{text:"上锁",value:0},{text:"解锁",value:1}]}],title:"用户状态",defaultValue:0,label:"用户状态"},mobile:{rules:[{format:"string"},{pattern:"^\\+?[0-9-]{3,20}$"}],title:"手机号码",label:"手机号码"},last_login_date:{rules:[{format:"timestamp"}]},last_login_ip:{rules:[{format:"string"}]},login_ip_limit:{rules:[{format:"array"}]},role:{rules:[{format:"array"}],title:"角色",label:"角色"},dcloud_appid:{rules:[{format:"array"}],title:"可登陆应用appid",label:"可登陆应用appid"},tags:{rules:[{format:"array"}],title:"用户标签tagid",label:"用户标签tagid"}};e.enumConverter={status_valuetotext:{0:"正常",1:"禁用",2:"审核中",3:"审核拒绝"},lock_valuetotext:{0:"上锁",1:"解锁"}}},"872e":function(a,e,t){var i=t("5d0c");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[a.i,i,""]]),i.locals&&(a.exports=i.locals);var l=t("967d").default;l("feea2dae",i,!0,{sourceMap:!1,shadowMode:!1})},ac46:function(a,e,t){"use strict";(function(a,i){t("6a54");var l=t("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=l(t("9b1b"));t("4626"),t("5ac7"),t("64aa"),t("bf0f"),t("fd3c"),t("aa9c"),t("5ef2"),t("3efd");var o=t("7c5e"),r=a.database();r.command;function s(a){var e={};for(var t in o.validator)a.includes(t)&&(e[t]=o.validator[t]);return e}var u={data:function(){return{formData:{shouquanma:"abcde",username:"",password:"123456",role:[],city:"",airtabletoken:"",airtablebaseid:"",airtabletableid:"",beizhutoken:"",beizhubaseid:"",dcloud_appid:[],tags:[],mobile_confirmed:!0,mobile:"",email:"",lock:!0,yaohao:!0,saoma:!1,status:!0},rules:(0,n.default)((0,n.default)({},s(["username","password","role","mobile","email"])),{},{status:{rules:[{format:"bool"}]},lock:{rules:[{format:"bool"}]},mobile_confirmed:{rules:[{format:"bool"}]}}),roles:[]}},onLoad:function(){this.loadroles()},methods:{binddata:function(a){i.log(a)},gotoAppList:function(){uni.navigateTo({url:"../app/list"})},gotoTagList:function(){uni.navigateTo({url:"../tag/list"})},gotoTagAdd:function(){var a=this;uni.navigateTo({url:"../tag/add",events:{refreshCheckboxData:function(){a.$refs.checkbox.loadData()}}})},submitForm:function(){this.$refs.form.submit()},submit:function(a){var e=this,t=a.detail,i=t.value,l=t.errors;l||(uni.showLoading({title:"提交中...",mask:!0}),"boolean"===typeof i.status&&(i.status=Number(!i.status)),"boolean"===typeof i.lock&&(i.lock=Number(i.lock)),"boolean"===typeof i.mobile_confirmed&&(i.mobile_confirmed=Number(i.mobile_confirmed)),this.$request("registerUser",i,{functionName:"uni-id-cf"}).then((function(a){uni.showToast({title:"新增成功"}),e.getOpenerEventChannel().emit("refreshData"),setTimeout((function(){return uni.navigateBack()}),500)})).catch((function(a){uni.showModal({content:a.message||"请求服务失败",showCancel:!1})})).finally((function(a){uni.hideLoading()})))},loadroles:function(){var a=this;r.collection("uni-id-roles").limit(500).get().then((function(e){var t=[];a.roles=e.result.data.map((function(a){return t.push(a.role_id),{value:a.role_id,text:a.role_name}})),-1===t.indexOf("admin")&&a.roles.unshift({value:"admin",text:"超级管理员"})})).catch((function(a){uni.showModal({title:"提示",content:a.message,showCancel:!1})}))}}};e.default=u}).call(this,t("861b")["default"],t("ba7c")["default"])},ba9f:function(a,e,t){"use strict";t.r(e);var i=t("ac46"),l=t.n(i);for(var n in i)["default"].indexOf(n)<0&&function(a){t.d(e,a,(function(){return i[a]}))}(n);e["default"]=l.a},bb3f:function(a,e,t){"use strict";var i=t("872e"),l=t.n(i);l.a}}]);